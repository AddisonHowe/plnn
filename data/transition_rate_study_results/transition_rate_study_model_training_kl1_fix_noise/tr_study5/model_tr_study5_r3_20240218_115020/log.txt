Args:
Namespace(name='model_tr_study5', outdir='out/transition_rate_study_model_training_kl1_fix_noise/tr_study5/model_tr_study5_r3', training_data='data/transition_rate_studies/tr_study5/tr_study5_training/r3', validation_data='data/transition_rate_studies/tr_study5/tr_study5_validation/r3', model_type='deep_phi', nsims_training=None, nsims_validation=None, num_epochs=1000, batch_size=100, report_every=10, ndims=2, nparams=2, nsigs=2, ncells=200, dt=0.1, signal_function='sigmoid', solver='heun', confine=True, confinement_factor=0.1, phi_hidden_dims=[16, 32, 32, 16], phi_hidden_acts=['softplus'], phi_final_act='None', phi_layer_normalize=False, tilt_hidden_dims=[0], tilt_hidden_acts=['None'], tilt_final_act='None', tilt_layer_normalize=False, infer_metric=False, metric_hidden_dims=[8, 8, 8, 8], metric_hidden_acts=['softplus', 'softplus', 'softplus', 'softplus'], metric_final_act=None, metric_layer_normalize=False, fix_noise=True, sigma=0.1, init_phi_weights_method='xavier_uniform', init_phi_weights_args=[], init_phi_bias_method='constant', init_phi_bias_args=[0.01], init_tilt_weights_method='xavier_uniform', init_tilt_weights_args=[], init_tilt_bias_method='constant', init_tilt_bias_args=[0.01], init_metric_weights_method='xavier_uniform', init_metric_weights_args=[], init_metric_bias_method=None, init_metric_bias_args=None, loss='kl', optimizer='rms', momentum=0.5, weight_decay=0.9, clip=1.0, lr_schedule='exponential_decay', learning_rate=0.01, nepochs_warmup=50, nepochs_decay=-1, final_learning_rate=0.0001, peak_learning_rate=0.02, warmup_cosine_decay_exponent=1.0, plot=True, dtype='float64', seed=0, timestamp=True, save_all=False, enforce_gpu=True, continuation=None)

Using seed: 516289720

Training model...

Saving initial model state to: out/transition_rate_study_model_training_kl1_fix_noise/tr_study5/model_tr_study5_r3_20240218_115020/states/model_tr_study5_0.pth
EPOCH 1/1000:
	Training over batches...
		[batch 5/5] avg loss: 11.744657305904646		[learning rate: 0.01]
	Learning Rate: 0.01
	LOSS [training: 11.744657305904646 | validation: 11.989912938583544]
	TIME [epoch: 80.5 sec]
	Saving model to: out/transition_rate_study_model_training_kl1_fix_noise/tr_study5/model_tr_study5_r3_20240218_115020/states/model_tr_study5_1.pth
	Model improved!!!
EPOCH 2/1000:
	Training over batches...
		[batch 5/5] avg loss: 11.379206888667698		[learning rate: 0.01]
	Learning Rate: 0.01
	LOSS [training: 11.379206888667698 | validation: 11.58613448543391]
	TIME [epoch: 9.7 sec]
	Saving model to: out/transition_rate_study_model_training_kl1_fix_noise/tr_study5/model_tr_study5_r3_20240218_115020/states/model_tr_study5_2.pth
	Model improved!!!
EPOCH 3/1000:
	Training over batches...
		[batch 5/5] avg loss: 10.673612588277024		[learning rate: 0.01]
	Learning Rate: 0.01
	LOSS [training: 10.673612588277024 | validation: 11.927261936087678]
	TIME [epoch: 9.69 sec]
EPOCH 4/1000:
	Training over batches...
		[batch 5/5] avg loss: 10.75923725281424		[learning rate: 0.01]
	Learning Rate: 0.01
	LOSS [training: 10.75923725281424 | validation: 11.078183104719463]
	TIME [epoch: 9.7 sec]
	Saving model to: out/transition_rate_study_model_training_kl1_fix_noise/tr_study5/model_tr_study5_r3_20240218_115020/states/model_tr_study5_4.pth
	Model improved!!!
EPOCH 5/1000:
	Training over batches...
		[batch 5/5] avg loss: 10.082028363679404		[learning rate: 0.01]
	Learning Rate: 0.01
	LOSS [training: 10.082028363679404 | validation: 10.422932584110791]
	TIME [epoch: 9.69 sec]
	Saving model to: out/transition_rate_study_model_training_kl1_fix_noise/tr_study5/model_tr_study5_r3_20240218_115020/states/model_tr_study5_5.pth
	Model improved!!!
EPOCH 6/1000:
	Training over batches...
		[batch 5/5] avg loss: 9.769326665036443		[learning rate: 0.01]
	Learning Rate: 0.01
	LOSS [training: 9.769326665036443 | validation: 10.872967328591143]
	TIME [epoch: 9.69 sec]
EPOCH 7/1000:
	Training over batches...
		[batch 5/5] avg loss: 9.43992819477784		[learning rate: 0.01]
	Learning Rate: 0.01
	LOSS [training: 9.43992819477784 | validation: 9.875400105649067]
	TIME [epoch: 9.69 sec]
	Saving model to: out/transition_rate_study_model_training_kl1_fix_noise/tr_study5/model_tr_study5_r3_20240218_115020/states/model_tr_study5_7.pth
	Model improved!!!
EPOCH 8/1000:
	Training over batches...
		[batch 5/5] avg loss: 8.764991087929065		[learning rate: 0.01]
	Learning Rate: 0.01
	LOSS [training: 8.764991087929065 | validation: 8.875973741043204]
	TIME [epoch: 9.71 sec]
	Saving model to: out/transition_rate_study_model_training_kl1_fix_noise/tr_study5/model_tr_study5_r3_20240218_115020/states/model_tr_study5_8.pth
	Model improved!!!
EPOCH 9/1000:
	Training over batches...
		[batch 5/5] avg loss: 8.273504409640202		[learning rate: 0.01]
	Learning Rate: 0.01
	LOSS [training: 8.273504409640202 | validation: 9.242530645889596]
	TIME [epoch: 9.69 sec]
EPOCH 10/1000:
	Training over batches...
		[batch 5/5] avg loss: 9.277261050324771		[learning rate: 0.01]
	Learning Rate: 0.01
	LOSS [training: 9.277261050324771 | validation: 9.635397069938499]
	TIME [epoch: 9.67 sec]
EPOCH 11/1000:
	Training over batches...
		[batch 5/5] avg loss: 10.115587647581574		[learning rate: 0.01]
	Learning Rate: 0.01
	LOSS [training: 10.115587647581574 | validation: 10.946729440354474]
	TIME [epoch: 9.68 sec]
EPOCH 12/1000:
	Training over batches...
		[batch 5/5] avg loss: 9.258158741189735		[learning rate: 0.01]
	Learning Rate: 0.01
	LOSS [training: 9.258158741189735 | validation: 10.676007209741984]
	TIME [epoch: 9.7 sec]
EPOCH 13/1000:
	Training over batches...
		[batch 5/5] avg loss: 9.024479083359088		[learning rate: 0.01]
	Learning Rate: 0.01
	LOSS [training: 9.024479083359088 | validation: 8.934659789034269]
	TIME [epoch: 9.69 sec]
EPOCH 14/1000:
	Training over batches...
		[batch 5/5] avg loss: 8.168516992078436		[learning rate: 0.01]
	Learning Rate: 0.01
	LOSS [training: 8.168516992078436 | validation: 8.942492529595611]
	TIME [epoch: 9.68 sec]
EPOCH 15/1000:
	Training over batches...
		[batch 5/5] avg loss: 8.163973632053416		[learning rate: 0.01]
	Learning Rate: 0.01
	LOSS [training: 8.163973632053416 | validation: 8.25194279912439]
	TIME [epoch: 9.69 sec]
	Saving model to: out/transition_rate_study_model_training_kl1_fix_noise/tr_study5/model_tr_study5_r3_20240218_115020/states/model_tr_study5_15.pth
	Model improved!!!
EPOCH 16/1000:
	Training over batches...
		[batch 5/5] avg loss: 8.354747827184838		[learning rate: 0.01]
	Learning Rate: 0.01
	LOSS [training: 8.354747827184838 | validation: 8.925446273266292]
	TIME [epoch: 9.69 sec]
EPOCH 17/1000:
	Training over batches...
		[batch 5/5] avg loss: 7.8137003892794095		[learning rate: 0.01]
	Learning Rate: 0.01
	LOSS [training: 7.8137003892794095 | validation: 8.901289630038601]
	TIME [epoch: 9.68 sec]
EPOCH 18/1000:
	Training over batches...
		[batch 5/5] avg loss: 8.911810607070262		[learning rate: 0.01]
	Learning Rate: 0.01
	LOSS [training: 8.911810607070262 | validation: 8.893813854500806]
	TIME [epoch: 9.68 sec]
EPOCH 19/1000:
	Training over batches...
		[batch 5/5] avg loss: 9.22971723709502		[learning rate: 0.01]
	Learning Rate: 0.01
	LOSS [training: 9.22971723709502 | validation: 8.511460205775206]
	TIME [epoch: 9.7 sec]
EPOCH 20/1000:
	Training over batches...
		[batch 5/5] avg loss: 8.237929981655306		[learning rate: 0.01]
	Learning Rate: 0.01
	LOSS [training: 8.237929981655306 | validation: 8.488473431395407]
	TIME [epoch: 9.68 sec]
EPOCH 21/1000:
	Training over batches...
		[batch 5/5] avg loss: 8.052376164205345		[learning rate: 0.01]
	Learning Rate: 0.01
	LOSS [training: 8.052376164205345 | validation: 8.43307146270969]
	TIME [epoch: 9.68 sec]
EPOCH 22/1000:
	Training over batches...
		[batch 5/5] avg loss: 7.894199455095988		[learning rate: 0.01]
	Learning Rate: 0.01
	LOSS [training: 7.894199455095988 | validation: 9.784976094059632]
	TIME [epoch: 9.68 sec]
EPOCH 23/1000:
	Training over batches...
		[batch 5/5] avg loss: 7.8272201019679155		[learning rate: 0.01]
	Learning Rate: 0.01
	LOSS [training: 7.8272201019679155 | validation: 8.256280313397292]
	TIME [epoch: 9.69 sec]
EPOCH 24/1000:
	Training over batches...
		[batch 5/5] avg loss: 7.8986667447334895		[learning rate: 0.01]
	Learning Rate: 0.01
	LOSS [training: 7.8986667447334895 | validation: 9.20532588435286]
	TIME [epoch: 9.68 sec]
EPOCH 25/1000:
	Training over batches...
		[batch 5/5] avg loss: 7.6685792857475175		[learning rate: 0.01]
	Learning Rate: 0.01
	LOSS [training: 7.6685792857475175 | validation: 8.085310537489798]
	TIME [epoch: 9.68 sec]
	Saving model to: out/transition_rate_study_model_training_kl1_fix_noise/tr_study5/model_tr_study5_r3_20240218_115020/states/model_tr_study5_25.pth
	Model improved!!!
EPOCH 26/1000:
	Training over batches...
		[batch 5/5] avg loss: 7.252361597662191		[learning rate: 0.01]
	Learning Rate: 0.01
	LOSS [training: 7.252361597662191 | validation: 7.944155210347526]
	TIME [epoch: 9.69 sec]
	Saving model to: out/transition_rate_study_model_training_kl1_fix_noise/tr_study5/model_tr_study5_r3_20240218_115020/states/model_tr_study5_26.pth
	Model improved!!!
EPOCH 27/1000:
	Training over batches...
		[batch 5/5] avg loss: 7.275340731209778		[learning rate: 0.01]
	Learning Rate: 0.01
	LOSS [training: 7.275340731209778 | validation: 7.764969371289385]
	TIME [epoch: 9.7 sec]
	Saving model to: out/transition_rate_study_model_training_kl1_fix_noise/tr_study5/model_tr_study5_r3_20240218_115020/states/model_tr_study5_27.pth
	Model improved!!!
EPOCH 28/1000:
	Training over batches...
		[batch 5/5] avg loss: 8.01221340517677		[learning rate: 0.01]
	Learning Rate: 0.01
	LOSS [training: 8.01221340517677 | validation: 7.902104403153571]
	TIME [epoch: 9.67 sec]
EPOCH 29/1000:
	Training over batches...
		[batch 5/5] avg loss: 7.768974188502881		[learning rate: 0.01]
	Learning Rate: 0.01
	LOSS [training: 7.768974188502881 | validation: 8.259712464484107]
	TIME [epoch: 9.66 sec]
EPOCH 30/1000:
	Training over batches...
		[batch 5/5] avg loss: 7.043915058206009		[learning rate: 0.01]
	Learning Rate: 0.01
	LOSS [training: 7.043915058206009 | validation: 7.6675267365422926]
	TIME [epoch: 9.68 sec]
	Saving model to: out/transition_rate_study_model_training_kl1_fix_noise/tr_study5/model_tr_study5_r3_20240218_115020/states/model_tr_study5_30.pth
	Model improved!!!
EPOCH 31/1000:
	Training over batches...
		[batch 5/5] avg loss: 7.343988627003239		[learning rate: 0.01]
	Learning Rate: 0.01
	LOSS [training: 7.343988627003239 | validation: 7.607105833777016]
	TIME [epoch: 9.66 sec]
	Saving model to: out/transition_rate_study_model_training_kl1_fix_noise/tr_study5/model_tr_study5_r3_20240218_115020/states/model_tr_study5_31.pth
	Model improved!!!
EPOCH 32/1000:
	Training over batches...
		[batch 5/5] avg loss: 7.514235265346739		[learning rate: 0.01]
	Learning Rate: 0.01
	LOSS [training: 7.514235265346739 | validation: 8.702806188745631]
	TIME [epoch: 9.68 sec]
EPOCH 33/1000:
	Training over batches...
		[batch 5/5] avg loss: 7.346083272664261		[learning rate: 0.01]
	Learning Rate: 0.01
	LOSS [training: 7.346083272664261 | validation: 7.382991589628188]
	TIME [epoch: 9.67 sec]
	Saving model to: out/transition_rate_study_model_training_kl1_fix_noise/tr_study5/model_tr_study5_r3_20240218_115020/states/model_tr_study5_33.pth
	Model improved!!!
EPOCH 34/1000:
	Training over batches...
		[batch 5/5] avg loss: 6.903693961175437		[learning rate: 0.01]
	Learning Rate: 0.01
	LOSS [training: 6.903693961175437 | validation: 7.716377530890426]
	TIME [epoch: 9.7 sec]
EPOCH 35/1000:
	Training over batches...
		[batch 5/5] avg loss: 7.343315996545378		[learning rate: 0.01]
	Learning Rate: 0.01
	LOSS [training: 7.343315996545378 | validation: 7.299213508765847]
	TIME [epoch: 9.68 sec]
	Saving model to: out/transition_rate_study_model_training_kl1_fix_noise/tr_study5/model_tr_study5_r3_20240218_115020/states/model_tr_study5_35.pth
	Model improved!!!
EPOCH 36/1000:
	Training over batches...
		[batch 5/5] avg loss: 6.787735451212032		[learning rate: 0.01]
	Learning Rate: 0.01
	LOSS [training: 6.787735451212032 | validation: 7.116489369099111]
	TIME [epoch: 9.67 sec]
	Saving model to: out/transition_rate_study_model_training_kl1_fix_noise/tr_study5/model_tr_study5_r3_20240218_115020/states/model_tr_study5_36.pth
	Model improved!!!
EPOCH 37/1000:
	Training over batches...
		[batch 5/5] avg loss: 7.081916168234946		[learning rate: 0.01]
	Learning Rate: 0.01
	LOSS [training: 7.081916168234946 | validation: 7.034403494957746]
	TIME [epoch: 9.68 sec]
	Saving model to: out/transition_rate_study_model_training_kl1_fix_noise/tr_study5/model_tr_study5_r3_20240218_115020/states/model_tr_study5_37.pth
	Model improved!!!
EPOCH 38/1000:
	Training over batches...
		[batch 5/5] avg loss: 6.962940315576224		[learning rate: 0.01]
	Learning Rate: 0.01
	LOSS [training: 6.962940315576224 | validation: 7.5672835084181465]
	TIME [epoch: 9.69 sec]
EPOCH 39/1000:
	Training over batches...
		[batch 5/5] avg loss: 6.98640596723326		[learning rate: 0.01]
	Learning Rate: 0.01
	LOSS [training: 6.98640596723326 | validation: 7.034616082859475]
	TIME [epoch: 9.67 sec]
EPOCH 40/1000:
	Training over batches...
		[batch 5/5] avg loss: 6.951988730317739		[learning rate: 0.01]
	Learning Rate: 0.01
	LOSS [training: 6.951988730317739 | validation: 6.874469937804767]
	TIME [epoch: 9.67 sec]
	Saving model to: out/transition_rate_study_model_training_kl1_fix_noise/tr_study5/model_tr_study5_r3_20240218_115020/states/model_tr_study5_40.pth
	Model improved!!!
EPOCH 41/1000:
	Training over batches...
		[batch 5/5] avg loss: 7.053486969416063		[learning rate: 0.01]
	Learning Rate: 0.01
	LOSS [training: 7.053486969416063 | validation: 7.389891233259152]
	TIME [epoch: 9.69 sec]
EPOCH 42/1000:
	Training over batches...
		[batch 5/5] avg loss: 6.434719344789167		[learning rate: 0.01]
	Learning Rate: 0.01
	LOSS [training: 6.434719344789167 | validation: 7.653556598055614]
	TIME [epoch: 9.68 sec]
EPOCH 43/1000:
	Training over batches...
		[batch 5/5] avg loss: 6.380842455387834		[learning rate: 0.01]
	Learning Rate: 0.01
	LOSS [training: 6.380842455387834 | validation: 6.531566813509853]
	TIME [epoch: 9.68 sec]
	Saving model to: out/transition_rate_study_model_training_kl1_fix_noise/tr_study5/model_tr_study5_r3_20240218_115020/states/model_tr_study5_43.pth
	Model improved!!!
EPOCH 44/1000:
	Training over batches...
		[batch 5/5] avg loss: 6.015915347754091		[learning rate: 0.01]
	Learning Rate: 0.01
	LOSS [training: 6.015915347754091 | validation: 7.574646841336232]
	TIME [epoch: 9.68 sec]
EPOCH 45/1000:
	Training over batches...
		[batch 5/5] avg loss: 6.373908150127453		[learning rate: 0.01]
	Learning Rate: 0.01
	LOSS [training: 6.373908150127453 | validation: 6.505865197799192]
	TIME [epoch: 9.69 sec]
	Saving model to: out/transition_rate_study_model_training_kl1_fix_noise/tr_study5/model_tr_study5_r3_20240218_115020/states/model_tr_study5_45.pth
	Model improved!!!
EPOCH 46/1000:
	Training over batches...
		[batch 5/5] avg loss: 6.246272543017889		[learning rate: 0.01]
	Learning Rate: 0.01
	LOSS [training: 6.246272543017889 | validation: 6.560506067763124]
	TIME [epoch: 9.68 sec]
EPOCH 47/1000:
	Training over batches...
		[batch 5/5] avg loss: 6.0665248048819755		[learning rate: 0.01]
	Learning Rate: 0.01
	LOSS [training: 6.0665248048819755 | validation: 7.02698732594434]
	TIME [epoch: 9.68 sec]
EPOCH 48/1000:
	Training over batches...
		[batch 5/5] avg loss: 6.141804478879541		[learning rate: 0.01]
	Learning Rate: 0.01
	LOSS [training: 6.141804478879541 | validation: 7.3026688421004975]
	TIME [epoch: 9.68 sec]
EPOCH 49/1000:
	Training over batches...
		[batch 5/5] avg loss: 6.01218324312543		[learning rate: 0.01]
	Learning Rate: 0.01
	LOSS [training: 6.01218324312543 | validation: 7.315004711131021]
	TIME [epoch: 9.7 sec]
EPOCH 50/1000:
	Training over batches...
		[batch 5/5] avg loss: 6.132171924613847		[learning rate: 0.01]
	Learning Rate: 0.01
	LOSS [training: 6.132171924613847 | validation: 6.331043964573546]
	TIME [epoch: 9.67 sec]
	Saving model to: out/transition_rate_study_model_training_kl1_fix_noise/tr_study5/model_tr_study5_r3_20240218_115020/states/model_tr_study5_50.pth
	Model improved!!!
EPOCH 51/1000:
	Training over batches...
		[batch 5/5] avg loss: 5.9852746526923895		[learning rate: 0.0099613]
	Learning Rate: 0.00996129
	LOSS [training: 5.9852746526923895 | validation: 6.429515682612312]
	TIME [epoch: 9.69 sec]
EPOCH 52/1000:
	Training over batches...
		[batch 5/5] avg loss: 5.891505512943145		[learning rate: 0.0099131]
	Learning Rate: 0.00991312
	LOSS [training: 5.891505512943145 | validation: 6.35762436401425]
	TIME [epoch: 9.7 sec]
EPOCH 53/1000:
	Training over batches...
		[batch 5/5] avg loss: 5.84474505219068		[learning rate: 0.0098652]
	Learning Rate: 0.00986519
	LOSS [training: 5.84474505219068 | validation: 6.31317443985372]
	TIME [epoch: 9.71 sec]
	Saving model to: out/transition_rate_study_model_training_kl1_fix_noise/tr_study5/model_tr_study5_r3_20240218_115020/states/model_tr_study5_53.pth
	Model improved!!!
EPOCH 54/1000:
	Training over batches...
		[batch 5/5] avg loss: 5.853431582625407		[learning rate: 0.0098175]
	Learning Rate: 0.00981748
	LOSS [training: 5.853431582625407 | validation: 7.232257082338913]
	TIME [epoch: 9.68 sec]
EPOCH 55/1000:
	Training over batches...
		[batch 5/5] avg loss: 6.175159069295375		[learning rate: 0.00977]
	Learning Rate: 0.00977
	LOSS [training: 6.175159069295375 | validation: 6.541486625050911]
	TIME [epoch: 9.67 sec]
EPOCH 56/1000:
	Training over batches...
		[batch 5/5] avg loss: 5.9626911821949795		[learning rate: 0.0097228]
	Learning Rate: 0.00972276
	LOSS [training: 5.9626911821949795 | validation: 7.284892651529964]
	TIME [epoch: 9.69 sec]
EPOCH 57/1000:
	Training over batches...
		[batch 5/5] avg loss: 6.01771099416492		[learning rate: 0.0096757]
	Learning Rate: 0.00967574
	LOSS [training: 6.01771099416492 | validation: 6.325372206358692]
	TIME [epoch: 9.67 sec]
EPOCH 58/1000:
	Training over batches...
		[batch 5/5] avg loss: 5.662225937469637		[learning rate: 0.009629]
	Learning Rate: 0.00962895
	LOSS [training: 5.662225937469637 | validation: 6.205703112157894]
	TIME [epoch: 9.67 sec]
	Saving model to: out/transition_rate_study_model_training_kl1_fix_noise/tr_study5/model_tr_study5_r3_20240218_115020/states/model_tr_study5_58.pth
	Model improved!!!
EPOCH 59/1000:
	Training over batches...
		[batch 5/5] avg loss: 5.851834845501456		[learning rate: 0.0095824]
	Learning Rate: 0.00958239
	LOSS [training: 5.851834845501456 | validation: 6.290815343827817]
	TIME [epoch: 9.69 sec]
EPOCH 60/1000:
	Training over batches...
Encountered nan in loss. Reverting update. New model dt0: 0.05
Encountered nan in loss. Reverting update. New model dt0: 0.025
Encountered nan in loss. Reverting update. New model dt0: 0.0125
Encountered nan in loss. Reverting update. New model dt0: 0.00625
Encountered nan in loss. Reverting update. New model dt0: 0.003125
